<UserControl x:Class="LanguageSchoolERP.App.Views.StudentContactsExportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             UseLayoutRounding="True"
             SnapsToDevicePixels="True">
    <UserControl.Resources>
        <Style x:Key="CenteredCheckBoxCellStyle" TargetType="CheckBox">
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="CenteredHeaderStyle" TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
    </UserControl.Resources>
    <Grid Margin="2">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Background="{StaticResource Brush.SurfaceAlt}" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="10" Padding="14" Margin="0,0,0,14">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel>
                    <TextBlock Text="Εξαγωγή Επαφών Μαθητών" FontSize="24" FontWeight="SemiBold"/>
                    <TextBlock Margin="0,4,0,0" Foreground="{StaticResource Brush.TextSecondary}" Text="Αναζήτηση και πολλαπλή επιλογή μαθητών για δημιουργία mailing list."/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Width="110" Margin="0,0,8,0" Content="Ανανέωση" Command="{Binding RefreshCommand}"/>
                    <Button Width="145" Content="Εξαγωγή σε Excel" Command="{Binding ExportCommand}"/>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="330"/>
            </Grid.ColumnDefinitions>

            <Border BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="10" Padding="12" Background="White" Margin="0,0,12,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <DockPanel Margin="0,0,0,8" LastChildFill="False">
                        <TextBox Height="32"
                                 Width="280"
                                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                 ToolTip="Αναζήτηση μαθητή, προγράμματος ή τάξης/επιπέδου"
                                 DockPanel.Dock="Left"/>

                        <ComboBox Height="32"
                                  Width="170"
                                  Margin="10,0,0,0"
                                  ItemsSource="{Binding AcademicYears}"
                                  SelectedItem="{Binding SelectedAcademicYear, Mode=TwoWay}"
                                  ToolTip="Επιλογή ακαδημαϊκού έτους"
                                  DockPanel.Dock="Left"/>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="10,0,0,0">
                            <Button Content="Επιλογή εμφανιζόμενων" Width="150" Margin="0,0,8,0" Command="{Binding SelectAllCommand}"/>
                            <Button Content="Καθαρισμός" Width="100" Command="{Binding ClearSelectionCommand}"/>
                        </StackPanel>
                    </DockPanel>

                    <DataGrid x:Name="StudentsGrid"
                              Grid.Row="1"
                              PreviewMouseLeftButtonUp="StudentsGrid_PreviewMouseLeftButtonUp"
                              ItemsSource="{Binding Students}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              IsReadOnly="False"
                              SelectionMode="Extended">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Επιλογή" Binding="{Binding IsSelected, Mode=TwoWay}" Width="80"
                                                    ElementStyle="{StaticResource CenteredCheckBoxCellStyle}"
                                                    EditingElementStyle="{StaticResource CenteredCheckBoxCellStyle}"
                                                    HeaderStyle="{StaticResource CenteredHeaderStyle}"/>
                            <DataGridTextColumn Header="Μαθητής" Binding="{Binding StudentName}" Width="*" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Πρόγραμμα" Binding="{Binding ProgramName}" Width="190" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Τάξη/Επίπεδο" Binding="{Binding LevelOrClass}" Width="150" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <TextBlock Grid.Row="2" Text="{Binding ErrorMessage}" Foreground="IndianRed" Margin="0,8,0,0"/>
                </Grid>
            </Border>

            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="10" Padding="12" Background="White">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="Πεδία εξαγωγής" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,8"/>
                            <TextBlock Text="Στοιχεία μαθητή" FontWeight="SemiBold" Margin="0,0,0,4"/>
                            <CheckBox Content="Ημ/νία Γέννησης" IsChecked="{Binding IncludeStudentDateOfBirth, Mode=TwoWay}"/>
                            <CheckBox Content="Κινητό" IsChecked="{Binding IncludeStudentMobile, Mode=TwoWay}"/>
                            <CheckBox Content="Σταθερό" IsChecked="{Binding IncludeStudentLandline, Mode=TwoWay}"/>
                            <CheckBox Content="Email" IsChecked="{Binding IncludeStudentEmail, Mode=TwoWay}"/>
                            <CheckBox Content="Σχολείο" IsChecked="{Binding IncludeSchoolName, Mode=TwoWay}"/>

                            <Separator Margin="0,8,0,8"/>
                            <TextBlock Text="Father's Data" FontWeight="SemiBold" Margin="0,0,0,4"/>
                            <CheckBox Content="Ονοματεπώνυμο Πατέρα" IsChecked="{Binding IncludeFatherName, Mode=TwoWay}"/>
                            <CheckBox Content="Email Πατέρα" IsChecked="{Binding IncludeFatherEmail, Mode=TwoWay}"/>
                            <CheckBox Content="Κινητό Πατέρα" IsChecked="{Binding IncludeFatherMobile, Mode=TwoWay}"/>
                            <CheckBox Content="Σταθερό Πατέρα" IsChecked="{Binding IncludeFatherLandline, Mode=TwoWay}"/>

                            <Separator Margin="0,8,0,8"/>
                            <TextBlock Text="Mother's Data" FontWeight="SemiBold" Margin="0,0,0,4"/>
                            <CheckBox Content="Ονοματεπώνυμο Μητέρας" IsChecked="{Binding IncludeMotherName, Mode=TwoWay}"/>
                            <CheckBox Content="Email Μητέρας" IsChecked="{Binding IncludeMotherEmail, Mode=TwoWay}"/>
                            <CheckBox Content="Κινητό Μητέρας" IsChecked="{Binding IncludeMotherMobile, Mode=TwoWay}"/>
                            <CheckBox Content="Σταθερό Μητέρας" IsChecked="{Binding IncludeMotherLandline, Mode=TwoWay}"/>
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <Border Grid.Row="2" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="10" Padding="12" Background="White">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="Επιλεγμένοι μαθητές (όλα τα έτη)" FontWeight="SemiBold" Margin="0,0,0,8"/>
                        <ListBox Grid.Row="1" ItemsSource="{Binding SelectedStudents}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding StudentName}"/>
                                        <TextBlock Text=" - " Foreground="Gray"/>
                                        <TextBlock Text="{Binding AcademicYear}" Foreground="Gray"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
