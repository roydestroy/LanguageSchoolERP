<Window x:Class="LanguageSchoolERP.App.Windows.AddProgramEnrollmentWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding DialogTitle}" Height="750" Width="789"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <x:Array x:Key="InstallmentChoices" Type="{x:Type sys:String}" xmlns:sys="clr-namespace:System;assembly=mscorlib">
            <sys:String>0</sys:String>
            <sys:String>1</sys:String>
            <sys:String>2</sys:String>
            <sys:String>3</sys:String>
            <sys:String>4</sys:String>
            <sys:String>5</sys:String>
            <sys:String>6</sys:String>
            <sys:String>7</sys:String>
            <sys:String>8</sys:String>
            <sys:String>9</sys:String>
            <sys:String>10</sys:String>
            <sys:String>11</sys:String>
            <sys:String>12</sys:String>
        </x:Array>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <TextBlock Text="{Binding FormTitle}" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,12"/>

                <TextBlock Text="Πρόγραμμα"/>
                <ComboBox Margin="0,4,0,10"
                          ItemsSource="{Binding StudyPrograms}"
                          DisplayMemberPath="Name"
                          SelectedItem="{Binding SelectedStudyProgram}"/>

                <TextBlock Text="Επίπεδο / Τάξη"/>
                <TextBox Margin="0,4,0,10" Text="{Binding LevelOrClass}"/>

                <TextBlock Text="Σύνολο συμφωνίας (€)"/>
                <TextBox Margin="0,4,0,10" Text="{Binding AgreementTotalText}"/>

                <TextBlock Text="Βιβλία (€)"
                           Visibility="{Binding HasBooksOption, Converter={StaticResource BoolToVisibilityConverter}}"/>
                <TextBox Margin="0,4,0,10"
                         Text="{Binding BooksAmountText}"
                         Visibility="{Binding HasBooksOption, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <TextBlock Text="Προκαταβολή (€)"/>
                <TextBox Margin="0,4,0,10" Text="{Binding DownPaymentText}"/>

                <CheckBox Margin="0,0,0,10"
                          Content="Study Lab"
                          IsChecked="{Binding IncludesStudyLab}"
                          Visibility="{Binding HasStudyLabOption, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <StackPanel Margin="0,0,0,10"
                            Visibility="{Binding IncludesStudyLab, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBlock Text="Συνολική Τιμή Study Lab (€)"/>
                    <TextBox Margin="0,4,0,0" Text="{Binding StudyLabMonthlyPriceText, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <CheckBox Margin="0,0,0,10"
                          Content="Μεταφορά"
                          IsChecked="{Binding IncludesTransportation}"
                          Visibility="{Binding HasTransportOption, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <StackPanel Margin="0,0,0,10"
                            Visibility="{Binding IncludesTransportation, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBlock Text="Μηνιαία τιμή μεταφοράς (€)"/>
                    <TextBox Margin="0,4,0,0" Text="{Binding TransportationMonthlyPriceText, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>


                <CheckBox Margin="0,0,0,10"
                          Content="Διακοπή προγράμματος"
                          IsChecked="{Binding IsStopped}"
                          Visibility="{Binding IsEditMode, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <StackPanel Margin="0,0,0,10">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding IsEditMode}" Value="True"/>
                                        <Condition Binding="{Binding IsStopped}" Value="True"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <TextBlock Text="Ημερομηνία διακοπής"/>
                    <DatePicker Margin="0,4,0,10" SelectedDate="{Binding StoppedOn}"/>
                    <TextBlock Text="Αιτιολογία διακοπής"/>
                    <TextBox Margin="0,4,0,0" Text="{Binding StopReason}"/>
                </StackPanel>

                <TextBlock Text="Αριθμός δόσεων (0-12)"/>
                <ComboBox Margin="0,4,0,10"
                          ItemsSource="{StaticResource InstallmentChoices}"
                          IsEditable="False"
                          SelectedItem="{Binding InstallmentCountText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Text="Μήνας έναρξης δόσεων"/>
                <DatePicker Margin="0,4,0,12" SelectedDate="{Binding InstallmentStartMonth}"/>

                <TextBlock Text="Σχόλια εγγραφής"/>
                <TextBox Margin="0,4,0,0" Text="{Binding EnrollmentComments}" AcceptsReturn="True" Height="90" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>
            </StackPanel>
        </ScrollViewer>

        <Grid Grid.Row="1" Margin="0,14,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="{Binding ErrorMessage}" Foreground="IndianRed" Margin="0,0,0,8"/>

            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Ακύρωση" Width="100" Margin="0,0,8,0" IsCancel="True"/>
                <Button Content="{Binding SaveButtonText}" Width="140" Command="{Binding SaveCommand}"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
