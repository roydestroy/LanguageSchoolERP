<Window x:Class="LanguageSchoolERP.App.Windows.NewStudentWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="New Student" Height="760" Width="860"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Create Student + Enrollment"
                   FontSize="20" FontWeight="SemiBold"
                   Margin="0,0,0,12"/>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left: Student -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Student Details" FontWeight="SemiBold" Margin="0,0,0,8"/>

                    <TextBlock Text="Student name"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding StudentName, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Student surname"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding StudentSurname, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Date of birth (optional)"/>
                    <DatePicker Margin="0,4,0,10" SelectedDate="{Binding DateOfBirth}"/>

                    <TextBlock Text="Phone"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding Phone}"/>

                    <TextBlock Text="Email"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding Email}"/>

                    <TextBlock Text="Notes"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding Notes}" AcceptsReturn="True" Height="90" TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Right: Parents + Enrollment -->
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Parent Details" FontWeight="SemiBold" Margin="0,0,0,8"/>

                    <TextBlock Text="Father name"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding FatherName, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Father surname"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding FatherSurname, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Father phone"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding FatherPhone, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Father email"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding FatherEmail, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Mother name"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding MotherName, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Mother surname"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding MotherSurname, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Mother phone"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding MotherPhone, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Mother email"/>
                    <TextBox Margin="0,4,0,16" Text="{Binding MotherEmail, UpdateSourceTrigger=PropertyChanged}"/>

                    <Separator Margin="0,6,0,12"/>

                    <TextBlock Text="Enrollment (Selected Academic Year)" FontWeight="SemiBold" Margin="0,0,0,8"/>

                    <TextBlock Text="Program"/>
                    <ComboBox Margin="0,4,0,10"
                              ItemsSource="{Binding ProgramTypes}"
                              SelectedItem="{Binding SelectedProgramType}"/>

                    <TextBlock Text="Level / Class"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding LevelOrClass}"/>

                    <TextBlock Text="Agreement total (€)"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding AgreementTotalText}"/>

                    <TextBlock Text="Books (€)"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding BooksAmountText}"/>

                    <TextBlock Text="Downpayment (€)"/>
                    <TextBox Margin="0,4,0,10" Text="{Binding DownPaymentText}"/>

                    <CheckBox Margin="0,0,0,10"
                              Content="Add Study Lab"
                              IsChecked="{Binding IncludesStudyLab}"
                              Visibility="{Binding IsLanguageSchoolProgram, Converter={StaticResource BoolToVisibilityConverter}}"/>

                    <StackPanel Margin="0,0,0,10"
                                Visibility="{Binding IncludesStudyLab, Converter={StaticResource BoolToVisibilityConverter}}">
                        <TextBlock Text="Study Lab monthly price (€)"/>
                        <TextBox Margin="0,4,0,0" Text="{Binding StudyLabMonthlyPriceText, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>

                    <CheckBox Margin="0,0,0,10"
                              Content="Add Transportation"
                              IsChecked="{Binding IncludesTransportation}"
                              Visibility="{Binding IsStudyLabProgram, Converter={StaticResource BoolToVisibilityConverter}}"/>

                    <StackPanel Margin="0,0,0,10"
                                Visibility="{Binding IncludesTransportation, Converter={StaticResource BoolToVisibilityConverter}}">
                        <TextBlock Text="Transportation monthly price (€)"/>
                        <TextBox Margin="0,4,0,0" Text="{Binding TransportationMonthlyPriceText, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
					
					<TextBlock Text="Installments count (e.g., 8)"/>
					<TextBox Margin="0,4,0,10" Text="{Binding InstallmentCountText}"/>

					<TextBlock Text="Installments start month"/>
					<DatePicker Margin="0,4,0,10" SelectedDate="{Binding InstallmentStartMonth}"/>

					<TextBlock Text="Enrollment comments"/>
                    <TextBox Margin="0,4,0,0" Text="{Binding EnrollmentComments}" AcceptsReturn="True" Height="70" TextWrapping="Wrap"/>
                </StackPanel>
            </Grid>
        </ScrollViewer>

        <!-- Buttons -->
        <DockPanel Grid.Row="2" Margin="0,14,0,0">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="IndianRed" VerticalAlignment="Center"/>

            <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                <Button Content="Cancel" Width="100" Margin="0,0,8,0" IsCancel="True"/>
                <Button Content="Create" Width="120" Command="{Binding CreateCommand}"/>
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
